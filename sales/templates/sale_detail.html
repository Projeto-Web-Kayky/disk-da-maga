{% extends 'base.html' %}
{% block title %}Comanda #{{ sale.id }}{% endblock %}
{% block content %}

<div class="p-6 max-w-6xl mx-auto space-y-8">

  <!-- CabeÃ§alho -->
  <div class="flex justify-between items-center rounded-2xl p-6 shadow-md {{ header_color }} bg-red-800 text-white">
    <div>
      <h2 class="text-3xl font-extrabold">ðŸ§¾ Comanda #{{ sale.id }}</h2>
      <p class="text-sm font-semibold text-gray-900">{% if sale.client %}
        <label class="text-sm flex">Cliente: {{ sale.client.name }} </label>
        {% else %}
        <label class="text-white">Cliente sem nome</label>{% endif %}
      </p>

      <p class="text-sm">Status:
        <span
          class="font-semibold {% if sale.status == 'open' %}text-green-400{% elif sale.status == 'finalized' %}text-success{% else %}text-error{% endif %}">
          {{ sale.get_status_display }}
        </span>
      </p>
    </div>

    <div class="flex gap-2">
      {% if sale.status == 'open' %}
      <button class="btn btn-success btn-sm" onclick="document.getElementById('pay-modal').showModal()">ðŸ’¸
        Registrar Pagamento</button>
      <button class="btn btn-accent btn-sm" onclick="document.getElementById('add-item-modal').showModal()">+
        Adicionar Item</button>
      {% endif %}
      <a href="{% url 'sale_list' %}" class="btn btn-outline btn-sm">â¬… Voltar</a>
    </div>
  </div>

  <!-- Itens -->
  <div id="sale-items" class="card bg-base-100 shadow-md border border-gray-200">
    <div class="card-body">
      <div class="flex justify-between items-center mb-3">
        <h3 class="text-lg font-semibold">ðŸ›’ Itens da Comanda</h3>
        {% if sale.status == 'open' %}
        <button class="btn btn-xs btn-accent" onclick="document.getElementById('add-item-modal').showModal()">+
          Adicionar</button>
        {% endif %}
      </div>

      <div class="divider"></div>

      {% include 'partials/sale_items_fragment.html' %}
    </div>
  </div>

  <!-- Modais -->
  {% include 'partials/modals/add_item_modal.html' %}
  {% include 'partials/modals/pay_modal.html' %}

</div>

{% endblock %}